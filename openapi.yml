openapi: 3.0.0
info:
  title: ASAP API
  version: 1.0.0
servers:
  - url: http://localhost:8080

paths:
  /api/oauth2/authorization/google:
    get:
      summary: Initiate Google OAuth2 login
      operationId: initiateGoogleOAuth2
      description: Redirects the user to Google's OAuth2 authorization endpoint to initiate the login process.
      responses:
        "302":
          description: Redirect to Google OAuth2 authorization endpoint

  /api/auth/login-link:
    post:
      summary: Create login link
      operationId: createLoginLink
      tags:
        - auth
      description: Generate a login link that will be sent to the user's email
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/LoginLinkRequest"
      responses:
        "201":
          description: Login link created successfully
        "400":
          description: Invalid email format
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /api/auth/exchange:
    get:
      summary: Exchange login link token for JWT
      operationId: exchangeLoginLink
      tags:
        - auth
      description: Exchange a login link token for a JWT access token by clicking the link from email
      parameters:
        - name: organizationId
          in: query
          required: false
          schema:
            type: string
            format: uuid
          description: Optional organization ID if the login link is associated with a specific organization
        - name: token
          in: query
          required: true
          schema:
            type: string
          description: The login link token received via email
        - name: twoFactorAuthCode
          in: query
          required: false
          schema:
            type: string
      responses:
        "200":
          description: Token exchange successful
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthMultiResponse"
        "400":
          description: Invalid or expired token
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Token not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /api/auth/refresh:
    post:
      summary: Refresh JWT token
      operationId: refreshToken
      tags:
        - auth
      description: Refresh an existing JWT token to extend its lifetime
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RefreshTokenRequest"
      responses:
        "200":
          description: Token refreshed successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Invalid or expired token
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /api/auth/login:
    post:
      summary: Login with email and password
      operationId: loginUser
      tags:
        - auth
      description: Authenticate user with email and password
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/LoginRequest"
      responses:
        "200":
          description: Login successful
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthMultiResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Invalid credentials
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /api/auth/forgot-password:
    post:
      summary: Request password reset
      operationId: forgotPassword
      tags:
        - auth
      description: Send password reset link to user's email
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ForgotPasswordRequest"
      responses:
        "200":
          description: Password reset email sent
        "400":
          description: Invalid email format
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: User not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /api/auth/reset-password:
    post:
      summary: Reset password with token
      operationId: resetPassword
      tags:
        - auth
      description: Reset user password using reset token
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ResetPasswordRequest"
      responses:
        "200":
          description: Password reset successful
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ResetPasswordMultiResponse"
        "400":
          description: Invalid request or token
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Token not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  # ========= Users =========

  /api/users/me:
    patch:
      summary: Update current user
      operationId: updateCurrentUser
      tags:
        - users
      security:
        - bearerAuth: []
      description: Update current user's profile information
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateUserRequest"
      responses:
        "200":
          description: User updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CurrentUser"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    get:
      summary: Get current user
      operationId: getCurrentUser
      tags:
        - users
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Current user details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CurrentUser"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /api/users/me/password:
    put:
      summary: Update current user's password
      operationId: updateCurrentUserPassword
      tags:
        - users
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdatePasswordRequest"
      responses:
        "200":
          description: Password updated successfully
        "400":
          description: Invalid request or incorrect current password
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /api/users/me/auth-methods:
    get:
      summary: Get current user's authentication methods configuration
      operationId: getCurrentUserAuthMethods
      tags:
        - users
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Current user's authentication methods
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserAuthMethods"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    put:
      summary: Update current user's authentication methods
      operationId: updateCurrentUserAuthMethods
      tags:
        - users
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateAuthMethodsRequest"
      responses:
        "200":
          description: Updated authentication methods
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserAuthMethods"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /api/users/me/email-preferences:
    get:
      summary: Get current user's email preferences
      operationId: getCurrentUserEmailPreferences
      tags:
        - users
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Current user's email preferences
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserEmailPreferences"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    put:
      summary: Update current user's email preferences
      operationId: updateCurrentUserEmailPreferences
      tags:
        - users
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              additionalProperties: true
      responses:
        "200":
          description: Updated email preferences
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserEmailPreferences"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /api/public/users/email-preferences:
    put:
      summary: Public update of user's email preferences using token
      operationId: updatePublicUserEmailPreferences
      tags:
        - users
      description: Update a user's email preferences using a token provided in emails. Token validity is signature-based; expiration is not enforced.
      parameters:
        - name: token
          in: query
          required: true
          schema:
            type: string
          description: Signed token used to authorize updates to the user's preferences
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              additionalProperties: true
      responses:
        "200":
          description: Updated email preferences
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserEmailPreferences"
        "400":
          description: Invalid request or token
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
    get:
      summary: Public get of user's email preferences using token
      operationId: getPublicUserEmailPreferences
      tags:
        - users
      parameters:
        - name: token
          in: query
          required: true
          schema:
            type: string
          description: Signed token used to authorize reading the user's preferences
      responses:
        "200":
          description: Current user's email preferences
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserEmailPreferences"
        "400":
          description: Invalid request or token
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /api/admin/users:
    post:
      summary: Create user
      operationId: createAdminUser
      tags:
        - users
      security:
        - bearerAuth: []
      description: Create a new user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateUserRequest"
      responses:
        "200":
          description: User created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    get:
      summary: Find all users
      operationId: findAdminUsers
      tags:
        - users
      security:
        - bearerAuth: []
      description: Find all users
      parameters:
        - name: query
          in: query
          required: false
          schema:
            type: string
          description: Search query
        - name: organizationId
          in: query
          required: false
          schema:
            type: string
            format: uuid
          description: Organization ID filter
        - name: organizationName
          in: query
          required: false
          schema:
            type: string
          description: Organization name filter
        - name: page
          in: query
          required: false
          schema:
            type: integer
            format: int32
          description: Page number (starts from 0)
        - name: size
          in: query
          required: false
          schema:
            type: integer
            format: int32
          description: Number of items per page
        - name: sortBy
          in: query
          required: false
          schema:
            type: string
          description: Field to sort by
        - name: order
          in: query
          required: false
          schema:
            type: string
            enum: [asc, desc]
          description: Sort order
      responses:
        "200":
          description: Users response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedUserResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /api/admin/users/{id}:
    get:
      summary: Get user by ID
      operationId: getAdminUserById
      tags:
        - users
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: User ID
      responses:
        "200":
          description: User
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: User not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    patch:
      summary: Update user
      operationId: updateAdminUser
      tags:
        - users
      security:
        - bearerAuth: []
      description: Update a user
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: User ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateUserRequest"
      responses:
        "200":
          description: User updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: User not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    delete:
      summary: Delete user by ID
      operationId: deleteAdminUserById
      tags:
        - users
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: User ID
      responses:
        "200":
          description: User deleted successfully
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: User not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /api/users:
    post:
      summary: Create user
      operationId: createUser
      tags:
        - users
      security:
        - bearerAuth: []
      description: Create a new user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateUserRequest"
      responses:
        "200":
          description: User created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    get:
      summary: Find all users
      operationId: findUsers
      tags:
        - users
      security:
        - bearerAuth: []
      description: Find all users
      parameters:
        - name: query
          in: query
          required: false
          schema:
            type: string
          description: Search query
        - name: page
          in: query
          required: false
          schema:
            type: integer
            format: int32
          description: Page number (starts from 0)
        - name: size
          in: query
          required: false
          schema:
            type: integer
            format: int32
          description: Number of items per page
        - name: sortBy
          in: query
          required: false
          schema:
            type: string
          description: Field to sort by
        - name: order
          in: query
          required: false
          schema:
            type: string
            enum: [asc, desc]
          description: Sort order
      responses:
        "200":
          description: Users response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedUserResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /api/users/{id}:
    get:
      summary: Get user by ID
      operationId: getUserById
      tags:
        - users
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: User ID
      responses:
        "200":
          description: User
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: User not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    patch:
      summary: Update user
      operationId: updateUser
      tags:
        - users
      security:
        - bearerAuth: []
      description: Update a user
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: User ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateUserRequest"
      responses:
        "200":
          description: User updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: User not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    delete:
      summary: Delete user by ID
      operationId: deleteUserById
      tags:
        - users
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: User ID
      responses:
        "200":
          description: User deleted successfully
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: User not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  # ========= Organizations =========

  /api/organizations/switch:
    post:
      summary: Switch organization
      operationId: switchOrganization
      tags:
        - organizations
      security:
        - bearerAuth: []
      description: Switch to another organization
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SwitchOrganizationRequest"
      responses:
        "200":
          description: Switch successful
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Invalid credentials
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "429":
          description: Too many requests
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /api/organizations/available:
    get:
      summary: Find all available organizations
      operationId: findAvailableOrganizations
      tags:
        - organizations
      security:
        - bearerAuth: []
      description: Find all available organizations for the current user
      parameters:
        - name: name
          in: query
          required: false
          schema:
            type: string
          description: Organization name filter
        - name: page
          in: query
          required: false
          schema:
            type: integer
            format: int32
          description: Page number (starts from 0)
        - name: size
          in: query
          required: false
          schema:
            type: integer
            format: int32
          description: Number of items per page
        - name: sortBy
          in: query
          required: false
          schema:
            type: string
          description: Field to sort by
        - name: order
          in: query
          required: false
          schema:
            type: string
            enum: [asc, desc]
          description: Sort order
      responses:
        "200":
          description: Organizations response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedAvailableOrganizationResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /api/admin/organizations:
    post:
      summary: Create organization
      operationId: createAdminOrganization
      tags:
        - organizations
      security:
        - bearerAuth: []
      description: Create a new organization
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateOrganizationRequest"
      responses:
        "200":
          description: Organization created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Organization"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    get:
      summary: Find all organizations
      operationId: findAdminOrganizations
      tags:
        - organizations
      security:
        - bearerAuth: []
      description: Find all organizations
      parameters:
        - name: query
          in: query
          required: false
          schema:
            type: string
          description: Organization name
        - name: isActive
          in: query
          required: false
          schema:
            type: boolean
          description: Filter by active status
        - name: page
          in: query
          required: false
          schema:
            type: integer
            format: int32
          description: Page number (starts from 0)
        - name: size
          in: query
          required: false
          schema:
            type: integer
            format: int32
          description: Number of items per page
        - name: sortBy
          in: query
          required: false
          schema:
            type: string
          description: Field to sort by
        - name: order
          in: query
          required: false
          schema:
            type: string
            enum: [asc, desc]
          description: Sort order
      responses:
        "200":
          description: Organizations response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedOrganizationResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /api/admin/organizations/{id}:
    get:
      summary: Get organization by ID
      operationId: getAdminOrganizationById
      tags:
        - organizations
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Organization ID
      responses:
        "200":
          description: Organization
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Organization"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Organization not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    patch:
      summary: Update organization
      operationId: updateAdminOrganization
      tags:
        - organizations
      security:
        - bearerAuth: []
      description: Update an organization
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Organization ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateOrganizationRequest"
      responses:
        "200":
          description: Organization updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Organization"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Organization not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    delete:
      summary: Delete organization by ID
      operationId: deleteAdminOrganizationById
      tags:
        - organizations
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Organization ID
      responses:
        "200":
          description: Organization deleted successfully
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Organization not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  # ========= Organization Members =========

  /api/organizations/{id}/members:
    get:
      summary: List organization members
      operationId: listOrganizationMembers
      tags:
        - organizations
      security:
        - bearerAuth: []
      description: List all members of an organization with pagination
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Organization ID
        - name: query
          in: query
          required: false
          schema:
            type: string
          description: Search by name or email
        - name: role
          in: query
          required: false
          schema:
            $ref: "#/components/schemas/UserRole"
          description: Filter by role
        - name: isActive
          in: query
          required: false
          schema:
            type: boolean
          description: Filter by active status
        - name: page
          in: query
          required: false
          schema:
            type: integer
            format: int32
          description: Page number (starts from 0)
        - name: size
          in: query
          required: false
          schema:
            type: integer
            format: int32
          description: Number of items per page
        - name: sortBy
          in: query
          required: false
          schema:
            type: string
          description: Field to sort by
        - name: order
          in: query
          required: false
          schema:
            type: string
            enum: [asc, desc]
          description: Sort order
      responses:
        "200":
          description: Organization members
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedOrganizationMemberResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Organization not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    post:
      summary: Add organization member
      operationId: addOrganizationMember
      tags:
        - organizations
      security:
        - bearerAuth: []
      description: Add a new member to an organization by email
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Organization ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AddOrganizationMemberRequest"
      responses:
        "201":
          description: Member added successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrganizationMember"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Organization not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "409":
          description: Member already exists
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /api/organizations/{id}/members/{memberId}:
    patch:
      summary: Update organization member role
      operationId: updateOrganizationMember
      tags:
        - organizations
      security:
        - bearerAuth: []
      description: Update a member's role or active status within an organization
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Organization ID
        - name: memberId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Member ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateOrganizationMemberRequest"
      responses:
        "200":
          description: Member updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrganizationMember"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Organization or member not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    delete:
      summary: Remove organization member
      operationId: removeOrganizationMember
      tags:
        - organizations
      security:
        - bearerAuth: []
      description: Remove a member from an organization
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Organization ID
        - name: memberId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Member ID
      responses:
        "204":
          description: Member removed successfully
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Organization or member not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  # ========= Phase 2: Tags =========

  /api/tag-groups:
    get:
      summary: List tag groups
      operationId: listTagGroups
      tags:
        - tag-groups
      responses:
        "200":
          description: List of tag groups
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/TagGroupResponse"
    post:
      summary: Create tag group
      operationId: createTagGroup
      tags:
        - tag-groups
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateTagGroupRequest"
      responses:
        "201":
          description: Tag group created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TagGroupResponse"

  /api/tag-groups/{id}:
    get:
      summary: Get tag group
      operationId: getTagGroup
      tags:
        - tag-groups
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Tag group details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TagGroupResponse"
    patch:
      summary: Update tag group
      operationId: updateTagGroup
      tags:
        - tag-groups
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateTagGroupRequest"
      responses:
        "200":
          description: Tag group updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TagGroupResponse"
    delete:
      summary: Delete tag group
      operationId: deleteTagGroup
      tags:
        - tag-groups
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Tag group deleted

  /api/tags:
    get:
      summary: List tags
      operationId: listTags
      tags:
        - tags
      parameters:
        - name: groupId
          in: query
          required: false
          schema:
            type: string
            format: uuid
        - name: search
          in: query
          required: false
          schema:
            type: string
      responses:
        "200":
          description: List of tags
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/TagResponse"
    post:
      summary: Create tag
      operationId: createTag
      tags:
        - tags
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateTagRequest"
      responses:
        "201":
          description: Tag created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TagResponse"

  /api/tags/{id}:
    get:
      summary: Get tag
      operationId: getTag
      tags:
        - tags
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Tag details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TagResponse"
    patch:
      summary: Update tag
      operationId: updateTag
      tags:
        - tags
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateTagRequest"
      responses:
        "200":
          description: Tag updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TagResponse"
    delete:
      summary: Delete tag
      operationId: deleteTag
      tags:
        - tags
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Tag deleted

  /api/tags/entity/{entityType}/{entityId}:
    get:
      summary: Get tags for entity
      operationId: getEntityTags
      tags:
        - tags
      parameters:
        - name: entityType
          in: path
          required: true
          schema:
            type: string
        - name: entityId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Tags for entity
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/TagResponse"
    post:
      summary: Apply tag to entity
      operationId: applyTagToEntity
      tags:
        - tags
      parameters:
        - name: entityType
          in: path
          required: true
          schema:
            type: string
        - name: entityId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ApplyTagRequest"
      responses:
        "201":
          description: Tag applied
    delete:
      summary: Remove tag from entity
      operationId: removeTagFromEntity
      tags:
        - tags
      parameters:
        - name: entityType
          in: path
          required: true
          schema:
            type: string
        - name: entityId
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: tagId
          in: query
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Tag removed

  # ========= Phase 2: Lookup Lists =========

  /api/lookup-lists:
    get:
      summary: List lookup lists
      operationId: listLookupLists
      tags:
        - lookup-lists
      responses:
        "200":
          description: List of lookup lists
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/LookupListResponse"
    post:
      summary: Create lookup list
      operationId: createLookupList
      tags:
        - lookup-lists
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateLookupListRequest"
      responses:
        "201":
          description: Lookup list created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LookupListResponse"

  /api/lookup-lists/{id}:
    get:
      summary: Get lookup list with items
      operationId: getLookupList
      tags:
        - lookup-lists
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Lookup list details with items
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LookupListDetailResponse"
    patch:
      summary: Update lookup list
      operationId: updateLookupList
      tags:
        - lookup-lists
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateLookupListRequest"
      responses:
        "200":
          description: Lookup list updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LookupListResponse"
    delete:
      summary: Delete lookup list
      operationId: deleteLookupList
      tags:
        - lookup-lists
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Lookup list deleted

  /api/lookup-lists/{id}/items:
    get:
      summary: List lookup list items
      operationId: listLookupListItems
      tags:
        - lookup-lists
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: List of items
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/LookupListItemResponse"
    post:
      summary: Create lookup list item
      operationId: createLookupListItem
      tags:
        - lookup-lists
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateLookupListItemRequest"
      responses:
        "201":
          description: Item created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LookupListItemResponse"

  /api/lookup-lists/{id}/items/{itemId}:
    patch:
      summary: Update lookup list item
      operationId: updateLookupListItem
      tags:
        - lookup-lists
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: itemId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateLookupListItemRequest"
      responses:
        "200":
          description: Item updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/LookupListItemResponse"
    delete:
      summary: Delete lookup list item
      operationId: deleteLookupListItem
      tags:
        - lookup-lists
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: itemId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Item deleted

  # ========= Phase 2: Custom Fields =========

  /api/custom-fields/{entityType}:
    get:
      summary: List custom field definitions
      operationId: listCustomFieldDefinitions
      tags:
        - custom-fields
      parameters:
        - name: entityType
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: List of custom field definitions
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/CustomFieldDefinitionResponse"
    post:
      summary: Create custom field definition
      operationId: createCustomFieldDefinition
      tags:
        - custom-fields
      parameters:
        - name: entityType
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateCustomFieldDefinitionRequest"
      responses:
        "201":
          description: Custom field definition created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CustomFieldDefinitionResponse"

  /api/custom-fields/{entityType}/{id}:
    patch:
      summary: Update custom field definition
      operationId: updateCustomFieldDefinition
      tags:
        - custom-fields
      parameters:
        - name: entityType
          in: path
          required: true
          schema:
            type: string
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateCustomFieldDefinitionRequest"
      responses:
        "200":
          description: Custom field definition updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CustomFieldDefinitionResponse"
    delete:
      summary: Delete custom field definition
      operationId: deleteCustomFieldDefinition
      tags:
        - custom-fields
      parameters:
        - name: entityType
          in: path
          required: true
          schema:
            type: string
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Custom field definition deleted

  # ========= Phase 2: Categories =========

  /api/categories:
    get:
      summary: List categories (tree)
      operationId: listCategories
      tags:
        - categories
      parameters:
        - name: type
          in: query
          required: false
          schema:
            type: string
      responses:
        "200":
          description: Category tree
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/CategoryResponse"
    post:
      summary: Create category
      operationId: createCategory
      tags:
        - categories
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateCategoryRequest"
      responses:
        "201":
          description: Category created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CategoryResponse"

  /api/categories/{id}:
    get:
      summary: Get category
      operationId: getCategory
      tags:
        - categories
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Category details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CategoryResponse"
    patch:
      summary: Update category
      operationId: updateCategory
      tags:
        - categories
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateCategoryRequest"
      responses:
        "200":
          description: Category updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CategoryResponse"
    delete:
      summary: Delete category
      operationId: deleteCategory
      tags:
        - categories
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Category deleted

  # ========= Phase 3: Clients =========

  /api/clients:
    get:
      summary: List clients
      operationId: listClients
      tags:
        - clients
      security:
        - bearerAuth: []
      description: List all clients with pagination and filtering
      parameters:
        - name: query
          in: query
          required: false
          schema:
            type: string
          description: Search query
        - name: type
          in: query
          required: false
          schema:
            type: string
          description: Filter by client type
        - name: isActive
          in: query
          required: false
          schema:
            type: boolean
          description: Filter by active status
        - name: page
          in: query
          required: false
          schema:
            type: integer
            format: int32
          description: Page number (starts from 0)
        - name: size
          in: query
          required: false
          schema:
            type: integer
            format: int32
          description: Number of items per page
        - name: sortBy
          in: query
          required: false
          schema:
            type: string
          description: Field to sort by
        - name: order
          in: query
          required: false
          schema:
            type: string
            enum: [asc, desc]
          description: Sort order
      responses:
        "200":
          description: Clients response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedClientResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    post:
      summary: Create client
      operationId: createClient
      tags:
        - clients
      security:
        - bearerAuth: []
      description: Create a new client
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateClientRequest"
      responses:
        "201":
          description: Client created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ClientResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /api/clients/{id}:
    get:
      summary: Get client by ID
      operationId: getClientById
      tags:
        - clients
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Client ID
      responses:
        "200":
          description: Client details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ClientResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Client not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    patch:
      summary: Update client
      operationId: updateClient
      tags:
        - clients
      security:
        - bearerAuth: []
      description: Update an existing client
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Client ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateClientRequest"
      responses:
        "200":
          description: Client updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ClientResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Client not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    delete:
      summary: Delete client
      operationId: deleteClient
      tags:
        - clients
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Client ID
      responses:
        "204":
          description: Client deleted successfully
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Client not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /api/clients/{id}/contacts:
    get:
      summary: List client contacts
      operationId: listClientContacts
      tags:
        - clients
      security:
        - bearerAuth: []
      description: List all contacts for a client
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Client ID
      responses:
        "200":
          description: Client contacts
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ClientContactResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Client not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    post:
      summary: Create client contact
      operationId: createClientContact
      tags:
        - clients
      security:
        - bearerAuth: []
      description: Add a new contact to a client
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Client ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateClientContactRequest"
      responses:
        "201":
          description: Contact created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ClientContactResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Client not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /api/clients/{id}/contacts/{contactId}:
    patch:
      summary: Update client contact
      operationId: updateClientContact
      tags:
        - clients
      security:
        - bearerAuth: []
      description: Update an existing client contact
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Client ID
        - name: contactId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Contact ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateClientContactRequest"
      responses:
        "200":
          description: Contact updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ClientContactResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Client or contact not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    delete:
      summary: Delete client contact
      operationId: deleteClientContact
      tags:
        - clients
      security:
        - bearerAuth: []
      description: Remove a contact from a client
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Client ID
        - name: contactId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Contact ID
      responses:
        "204":
          description: Contact deleted successfully
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Client or contact not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  # ========= Phase 3: Vendors =========

  /api/vendors:
    get:
      summary: List vendors
      operationId: listVendors
      tags:
        - vendors
      security:
        - bearerAuth: []
      description: List all vendors with pagination and filtering
      parameters:
        - name: query
          in: query
          required: false
          schema:
            type: string
          description: Search query
        - name: type
          in: query
          required: false
          schema:
            type: string
          description: Filter by vendor type
        - name: isActive
          in: query
          required: false
          schema:
            type: boolean
          description: Filter by active status
        - name: page
          in: query
          required: false
          schema:
            type: integer
            format: int32
          description: Page number (starts from 0)
        - name: size
          in: query
          required: false
          schema:
            type: integer
            format: int32
          description: Number of items per page
        - name: sortBy
          in: query
          required: false
          schema:
            type: string
          description: Field to sort by
        - name: order
          in: query
          required: false
          schema:
            type: string
            enum: [asc, desc]
          description: Sort order
      responses:
        "200":
          description: Vendors response
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedVendorResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    post:
      summary: Create vendor
      operationId: createVendor
      tags:
        - vendors
      security:
        - bearerAuth: []
      description: Create a new vendor
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateVendorRequest"
      responses:
        "201":
          description: Vendor created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/VendorResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /api/vendors/{id}:
    get:
      summary: Get vendor by ID
      operationId: getVendorById
      tags:
        - vendors
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Vendor ID
      responses:
        "200":
          description: Vendor details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/VendorResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Vendor not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    patch:
      summary: Update vendor
      operationId: updateVendor
      tags:
        - vendors
      security:
        - bearerAuth: []
      description: Update an existing vendor
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Vendor ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateVendorRequest"
      responses:
        "200":
          description: Vendor updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/VendorResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Vendor not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    delete:
      summary: Delete vendor
      operationId: deleteVendor
      tags:
        - vendors
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Vendor ID
      responses:
        "204":
          description: Vendor deleted successfully
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Vendor not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /api/vendors/{id}/contacts:
    get:
      summary: List vendor contacts
      operationId: listVendorContacts
      tags:
        - vendors
      security:
        - bearerAuth: []
      description: List all contacts for a vendor
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Vendor ID
      responses:
        "200":
          description: Vendor contacts
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/VendorContactResponse"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Vendor not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    post:
      summary: Create vendor contact
      operationId: createVendorContact
      tags:
        - vendors
      security:
        - bearerAuth: []
      description: Add a new contact to a vendor
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Vendor ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateVendorContactRequest"
      responses:
        "201":
          description: Contact created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/VendorContactResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Vendor not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

  /api/vendors/{id}/contacts/{contactId}:
    patch:
      summary: Update vendor contact
      operationId: updateVendorContact
      tags:
        - vendors
      security:
        - bearerAuth: []
      description: Update an existing vendor contact
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Vendor ID
        - name: contactId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Contact ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateVendorContactRequest"
      responses:
        "200":
          description: Contact updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/VendorContactResponse"
        "400":
          description: Invalid request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Vendor or contact not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

    delete:
      summary: Delete vendor contact
      operationId: deleteVendorContact
      tags:
        - vendors
      security:
        - bearerAuth: []
      description: Remove a contact from a vendor
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Vendor ID
        - name: contactId
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Contact ID
      responses:
        "204":
          description: Contact deleted successfully
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "403":
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"
        "404":
          description: Vendor or contact not found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Error"

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    # ========= Auth Schemas =========

    LoginLinkRequest:
      type: object
      properties:
        email:
          type: string
          format: email
          description: Email address of the user to send the login link to
      required:
        - email

    RefreshTokenRequest:
      type: object
      properties:
        refreshToken:
          type: string
          description: JWT refresh token
      required:
        - refreshToken

    LoginRequest:
      type: object
      properties:
        organizationId:
          type: string
          format: uuid
          description: Organization ID to login to
        email:
          type: string
          format: email
          description: User's email address
        password:
          type: string
          description: User's password
        twoFactorAuthCode:
          type: string
      required:
        - email
        - password

    ForgotPasswordRequest:
      type: object
      properties:
        email:
          type: string
          format: email
          description: User's email address
      required:
        - email

    AuthMultiResponse:
      oneOf:
        - $ref: "#/components/schemas/AuthResponse"
        - $ref: "#/components/schemas/AvailableOrganizationsResponse"

    ResetPasswordRequest:
      type: object
      properties:
        token:
          type: string
          description: Password reset token
        newPassword:
          type: string
          minLength: 8
          description: New password (minimum 8 characters)
      required:
        - token
        - newPassword

    AuthResponse:
      type: object
      properties:
        accessToken:
          type: string
          description: JWT access token
        refreshToken:
          type: string
          description: JWT refresh token
        twoFactorAuthToken:
          type: string
          description: Temporary token for 2FA verification (if applicable)
        twoFactorAuthRequired:
          type: boolean

    ResetPasswordResponse:
      type: object
      properties:
        success:
          type: boolean
          description: Whether the password reset was successful

    ResetPasswordMultiResponse:
      oneOf:
        - $ref: "#/components/schemas/AvailableOrganizationsResponse"
        - $ref: "#/components/schemas/ResetPasswordResponse"

    TwoFactorSetupResponse:
      type: object
      properties:
        secret:
          type: string
          description: TOTP secret key
        qrCode:
          type: string
          description: Base64 encoded QR code image
        uri:
          type: string
          description: TOTP URI for manual setup

    TwoFactorEnableRequest:
      type: object
      properties:
        code:
          type: string
          description: TOTP code to verify setup
      required:
        - code

    TwoFactorDisableRequest:
      type: object
      properties:
        code:
          type: string
          description: TOTP code to verify disable request
      required:
        - code

    TwoFactorStatusResponse:
      type: object
      properties:
        enabled:
          type: boolean
          description: Whether 2FA is enabled

    TwoFactorVerifyRequest:
      type: object
      properties:
        organizationId:
          type: string
          format: uuid
        token:
          type: string
          description: Temporary token or OTP from initial auth
        code:
          type: string
          description: TOTP code to verify (optional for OTP flow)
      required:
        - token

    # ========= Common Schemas =========

    Error:
      type: object
      properties:
        code:
          type: integer
          description: Error code
        message:
          type: string
          description: Human-readable error message
        timestamp:
          type: string
          format: date-time
          description: Timestamp when the error occurred
        path:
          type: string
          description: Request path that caused the error

    Timestamp:
      type: string
      format: date-time
      description: Timestamp in ISO 8601 format

    PaginatedResponse:
      type: object
      properties:
        page:
          type: integer
          description: Current page number (zero-based)
        size:
          type: integer
          description: Number of items per page
        totalElements:
          type: integer
          format: int64
          description: Total number of elements
        totalPages:
          type: integer
          description: Total number of pages

    # ========= User Schemas =========

    User:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Unique identifier for the user
        email:
          type: string
          description: Email address of the user
        firstName:
          type: string
          description: User's first name
        lastName:
          type: string
          description: User's last name
        phone:
          type: string
          description: User's phone number
        avatarUrl:
          type: string
          format: uri
          description: URL to the user's avatar image
        roles:
          type: array
          items:
            $ref: "#/components/schemas/UserRole"
          description: User's roles
        isActive:
          type: boolean
          description: Whether the user is active
        twoFactorAuthEnabled:
          type: boolean
          description: Whether two-factor authentication is enabled
        createdAt:
          $ref: "#/components/schemas/Timestamp"
        updatedAt:
          $ref: "#/components/schemas/Timestamp"

    CurrentUser:
      allOf:
        - $ref: "#/components/schemas/User"
        - type: object
          properties:
            organizationId:
              type: string
              format: uuid
              description: The current organization ID the user is operating in

    UserRole:
      type: string
      enum:
        - PLATFORM_ADMIN
        - OWNER
        - ADMIN
        - MEMBER
        - VIEWER
        - ACCOUNTANT

    CreateUserRequest:
      type: object
      required:
        - email
        - firstName
        - roles
      properties:
        organizationId:
          type: string
          format: uuid
          description: Organization ID
        email:
          type: string
          format: email
          description: Email address of the user
        firstName:
          type: string
          description: User's first name
        lastName:
          type: string
          description: User's last name
        phone:
          type: string
          description: User's phone number
        roles:
          type: array
          items:
            $ref: "#/components/schemas/UserRole"
        sendEmail:
          type: boolean
          description: Whether to send an invitation email to the user

    UpdateUserRequest:
      type: object
      properties:
        firstName:
          type: string
          nullable: true
          description: User's first name
        lastName:
          type: string
          nullable: true
          description: User's last name
        phone:
          type: string
          nullable: true
          description: User's phone number
        avatarUrl:
          type: string
          format: uri
          nullable: true
          description: URL to the user's avatar image
        roles:
          nullable: true
          type: array
          items:
            $ref: "#/components/schemas/UserRole"
          description: User's roles
      description: Request to update user profile information

    UpdatePasswordRequest:
      type: object
      properties:
        oldPassword:
          type: string
          description: Current password
        newPassword:
          type: string
          description: New password
        twoFactorAuthCode:
          type: string
          description: 2FA code (if applicable)

    UserAuthMethods:
      type: object
      properties:
        passwordEnabled:
          type: boolean
          description: Whether password authentication is enabled
        loginLinkEnabled:
          type: boolean
          description: Whether login link authentication is enabled
        googleEnabled:
          type: boolean
          description: Whether Google OAuth authentication is enabled

    UpdateAuthMethodsRequest:
      type: object
      properties:
        passwordEnabled:
          type: boolean
          description: Enable or disable password authentication
        loginLinkEnabled:
          type: boolean
          description: Enable or disable login link authentication
        googleEnabled:
          type: boolean
          description: Enable or disable Google OAuth authentication
        twoFactorAuthCode:
          type: string
          description: 2FA code (required if 2FA is active)

    UserEmailPreferences:
      type: object
      properties:
        email:
          type: string
          format: email
          description: User's email address
        preferences:
          type: object
          additionalProperties: true

    PaginatedUserResponse:
      allOf:
        - $ref: "#/components/schemas/PaginatedResponse"
        - type: object
          properties:
            items:
              type: array
              items:
                $ref: "#/components/schemas/User"
              description: List of users

    # ========= Organization Schemas =========

    Organization:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Organization ID
        name:
          type: string
          description: Organization name
        slug:
          type: string
          description: URL-friendly identifier for the organization
        isActive:
          type: boolean
          description: Whether the organization is active
        settings:
          type: object
          additionalProperties: true
          description: Organization-level settings
        billingInfo:
          type: object
          additionalProperties: true
          description: Organization billing information
        createdAt:
          $ref: "#/components/schemas/Timestamp"
        updatedAt:
          $ref: "#/components/schemas/Timestamp"

    AvailableOrganizationResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Organization ID
        name:
          type: string
          description: Organization name

    AvailableOrganizationsResponse:
      type: object
      properties:
        organizations:
          type: array
          items:
            $ref: "#/components/schemas/AvailableOrganizationResponse"
          description: List of available organizations for the user

    SwitchOrganizationRequest:
      type: object
      properties:
        organizationId:
          type: string
          format: uuid
          description: Organization ID to switch to

    CreateOrganizationRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
          description: Organization name
        slug:
          type: string
          description: URL-friendly identifier for the organization

    UpdateOrganizationRequest:
      type: object
      properties:
        name:
          nullable: true
          type: string
          description: Organization name
        slug:
          nullable: true
          type: string
          description: URL-friendly identifier for the organization
        isActive:
          nullable: true
          type: boolean
          description: Whether the organization is active
        settings:
          nullable: true
          type: object
          additionalProperties: true
          description: Organization-level settings
        billingInfo:
          nullable: true
          type: object
          additionalProperties: true
          description: Organization billing information

    PaginatedOrganizationResponse:
      allOf:
        - $ref: "#/components/schemas/PaginatedResponse"
        - type: object
          properties:
            items:
              type: array
              items:
                $ref: "#/components/schemas/Organization"
              description: List of organizations

    PaginatedAvailableOrganizationResponse:
      allOf:
        - $ref: "#/components/schemas/PaginatedResponse"
        - type: object
          properties:
            items:
              type: array
              items:
                $ref: "#/components/schemas/AvailableOrganizationResponse"
              description: List of available organizations for the user

    # ========= Organization Member Schemas =========

    OrganizationMember:
      type: object
      properties:
        id:
          type: string
          format: uuid
          description: Membership ID
        organizationId:
          type: string
          format: uuid
          description: Organization ID
        userId:
          type: string
          format: uuid
          description: User ID
        userEmail:
          type: string
          description: User's email address
        userFirstName:
          type: string
          description: User's first name
        userLastName:
          type: string
          description: User's last name
        role:
          $ref: "#/components/schemas/UserRole"
        isActive:
          type: boolean
          description: Whether the membership is active
        joinedAt:
          type: string
          format: date-time
          description: Timestamp when the member joined
        invitedAt:
          type: string
          format: date-time
          description: Timestamp when the member was invited

    AddOrganizationMemberRequest:
      type: object
      required:
        - email
        - role
      properties:
        email:
          type: string
          format: email
          description: Email address of the user to add
        role:
          $ref: "#/components/schemas/UserRole"

    UpdateOrganizationMemberRequest:
      type: object
      properties:
        role:
          $ref: "#/components/schemas/UserRole"
        isActive:
          type: boolean
          description: Whether the membership is active

    PaginatedOrganizationMemberResponse:
      allOf:
        - $ref: "#/components/schemas/PaginatedResponse"
        - type: object
          properties:
            items:
              type: array
              items:
                $ref: "#/components/schemas/OrganizationMember"
              description: List of organization members

    # ========= Phase 2: Tag Schemas =========

    TagGroupResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        color:
          type: string
        description:
          type: string
        createdAt:
          $ref: "#/components/schemas/Timestamp"

    CreateTagGroupRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
        color:
          type: string
        description:
          type: string

    UpdateTagGroupRequest:
      type: object
      properties:
        name:
          type: string
          nullable: true
        color:
          type: string
          nullable: true
        description:
          type: string
          nullable: true

    TagResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        color:
          type: string
        tagGroupId:
          type: string
          format: uuid
        tagGroupName:
          type: string
        createdAt:
          $ref: "#/components/schemas/Timestamp"

    CreateTagRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
        color:
          type: string
        tagGroupId:
          type: string
          format: uuid

    UpdateTagRequest:
      type: object
      properties:
        name:
          type: string
          nullable: true
        color:
          type: string
          nullable: true
        tagGroupId:
          type: string
          format: uuid
          nullable: true

    ApplyTagRequest:
      type: object
      required:
        - tagId
      properties:
        tagId:
          type: string
          format: uuid

    # ========= Phase 2: Lookup List Schemas =========

    LookupListResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        slug:
          type: string
        description:
          type: string
        isSystem:
          type: boolean
        isActive:
          type: boolean
        createdAt:
          $ref: "#/components/schemas/Timestamp"

    LookupListDetailResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        slug:
          type: string
        description:
          type: string
        isSystem:
          type: boolean
        isActive:
          type: boolean
        items:
          type: array
          items:
            $ref: "#/components/schemas/LookupListItemResponse"
        createdAt:
          $ref: "#/components/schemas/Timestamp"

    CreateLookupListRequest:
      type: object
      required:
        - name
        - slug
      properties:
        name:
          type: string
        slug:
          type: string
        description:
          type: string

    UpdateLookupListRequest:
      type: object
      properties:
        name:
          type: string
          nullable: true
        description:
          type: string
          nullable: true
        isActive:
          type: boolean
          nullable: true

    LookupListItemResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        value:
          type: string
        label:
          type: string
        color:
          type: string
        icon:
          type: string
        metadata:
          type: object
          additionalProperties: true
        parentId:
          type: string
          format: uuid
        isActive:
          type: boolean
        displayOrder:
          type: integer

    CreateLookupListItemRequest:
      type: object
      required:
        - value
        - label
      properties:
        value:
          type: string
        label:
          type: string
        color:
          type: string
        icon:
          type: string
        metadata:
          type: object
          additionalProperties: true
        parentId:
          type: string
          format: uuid
        displayOrder:
          type: integer

    UpdateLookupListItemRequest:
      type: object
      properties:
        label:
          type: string
          nullable: true
        color:
          type: string
          nullable: true
        icon:
          type: string
          nullable: true
        metadata:
          type: object
          additionalProperties: true
          nullable: true
        isActive:
          type: boolean
          nullable: true
        displayOrder:
          type: integer
          nullable: true

    # ========= Phase 2: Custom Field Schemas =========

    CustomFieldDefinitionResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        entityType:
          type: string
        fieldKey:
          type: string
        fieldLabel:
          type: string
        fieldType:
          type: string
        options:
          type: array
          items:
            type: object
        lookupListId:
          type: string
          format: uuid
        collectionSchema:
          type: array
          items:
            type: object
        minEntries:
          type: integer
        maxEntries:
          type: integer
        isRequired:
          type: boolean
        defaultValue:
          type: string
        isFilterable:
          type: boolean
        displayOrder:
          type: integer
        section:
          type: string
        showOnForm:
          type: boolean
        showOnCard:
          type: boolean
        dependsOnFieldId:
          type: string
          format: uuid
        dependsOnValue:
          type: string
        createdAt:
          $ref: "#/components/schemas/Timestamp"

    CreateCustomFieldDefinitionRequest:
      type: object
      required:
        - fieldKey
        - fieldLabel
        - fieldType
      properties:
        fieldKey:
          type: string
        fieldLabel:
          type: string
        fieldType:
          type: string
        options:
          type: array
          items:
            type: object
        lookupListId:
          type: string
          format: uuid
        collectionSchema:
          type: array
          items:
            type: object
        minEntries:
          type: integer
        maxEntries:
          type: integer
        isRequired:
          type: boolean
        defaultValue:
          type: string
        isFilterable:
          type: boolean
        displayOrder:
          type: integer
        section:
          type: string
        showOnForm:
          type: boolean
        showOnCard:
          type: boolean
        dependsOnFieldId:
          type: string
          format: uuid
        dependsOnValue:
          type: string

    UpdateCustomFieldDefinitionRequest:
      type: object
      properties:
        fieldLabel:
          type: string
          nullable: true
        options:
          type: array
          items:
            type: object
          nullable: true
        isRequired:
          type: boolean
          nullable: true
        defaultValue:
          type: string
          nullable: true
        isFilterable:
          type: boolean
          nullable: true
        displayOrder:
          type: integer
          nullable: true
        section:
          type: string
          nullable: true
        showOnForm:
          type: boolean
          nullable: true
        showOnCard:
          type: boolean
          nullable: true

    # ========= Phase 2: Category Schemas =========

    CategoryResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        code:
          type: string
        type:
          type: string
        description:
          type: string
        parentId:
          type: string
          format: uuid
        isActive:
          type: boolean
        displayOrder:
          type: integer
        children:
          type: array
          items:
            $ref: "#/components/schemas/CategoryResponse"
        createdAt:
          $ref: "#/components/schemas/Timestamp"

    CreateCategoryRequest:
      type: object
      required:
        - name
        - type
      properties:
        name:
          type: string
        code:
          type: string
        type:
          type: string
        description:
          type: string
        parentId:
          type: string
          format: uuid
        displayOrder:
          type: integer

    UpdateCategoryRequest:
      type: object
      properties:
        name:
          type: string
          nullable: true
        code:
          type: string
          nullable: true
        type:
          type: string
          nullable: true
        description:
          type: string
          nullable: true
        parentId:
          type: string
          format: uuid
          nullable: true
        isActive:
          type: boolean
          nullable: true
        displayOrder:
          type: integer
          nullable: true

    # ========= Phase 3: Client Schemas =========

    ClientResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        type:
          type: string
        email:
          type: string
        phone:
          type: string
        website:
          type: string
        billingAddress:
          type: object
          additionalProperties: true
        shippingAddress:
          type: object
          additionalProperties: true
        notes:
          type: string
        externalAccountingId:
          type: string
        pricingTier:
          type: string
        customFields:
          type: object
          additionalProperties: true
        isActive:
          type: boolean
        createdAt:
          $ref: "#/components/schemas/Timestamp"
        updatedAt:
          $ref: "#/components/schemas/Timestamp"

    CreateClientRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
        type:
          type: string
        email:
          type: string
        phone:
          type: string
        website:
          type: string
        billingAddress:
          type: object
          additionalProperties: true
        shippingAddress:
          type: object
          additionalProperties: true
        notes:
          type: string
        pricingTier:
          type: string
        customFields:
          type: object
          additionalProperties: true

    UpdateClientRequest:
      type: object
      properties:
        name:
          type: string
          nullable: true
        type:
          type: string
          nullable: true
        email:
          type: string
          nullable: true
        phone:
          type: string
          nullable: true
        website:
          type: string
          nullable: true
        notes:
          type: string
          nullable: true
        isActive:
          type: boolean
          nullable: true
        pricingTier:
          type: string
          nullable: true

    PaginatedClientResponse:
      allOf:
        - $ref: "#/components/schemas/PaginatedResponse"
        - type: object
          properties:
            items:
              type: array
              items:
                $ref: "#/components/schemas/ClientResponse"
              description: List of clients

    ClientContactResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        clientId:
          type: string
          format: uuid
        firstName:
          type: string
        lastName:
          type: string
        email:
          type: string
        phone:
          type: string
        role:
          type: string
        isPrimary:
          type: boolean
        notes:
          type: string
        createdAt:
          $ref: "#/components/schemas/Timestamp"

    CreateClientContactRequest:
      type: object
      required:
        - firstName
      properties:
        firstName:
          type: string
        lastName:
          type: string
        email:
          type: string
        phone:
          type: string
        role:
          type: string
        isPrimary:
          type: boolean

    UpdateClientContactRequest:
      type: object
      properties:
        firstName:
          type: string
          nullable: true
        lastName:
          type: string
          nullable: true
        email:
          type: string
          nullable: true
        phone:
          type: string
          nullable: true
        role:
          type: string
          nullable: true
        isPrimary:
          type: boolean
          nullable: true

    # ========= Phase 3: Vendor Schemas =========

    VendorResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        type:
          type: string
        email:
          type: string
        phone:
          type: string
        website:
          type: string
        billingAddress:
          type: object
          additionalProperties: true
        notes:
          type: string
        externalAccountingId:
          type: string
        paymentInfo:
          type: object
          additionalProperties: true
        customFields:
          type: object
          additionalProperties: true
        isActive:
          type: boolean
        createdAt:
          $ref: "#/components/schemas/Timestamp"
        updatedAt:
          $ref: "#/components/schemas/Timestamp"

    CreateVendorRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
        type:
          type: string
        email:
          type: string
        phone:
          type: string
        website:
          type: string
        billingAddress:
          type: object
          additionalProperties: true
        notes:
          type: string
        paymentInfo:
          type: object
          additionalProperties: true
        customFields:
          type: object
          additionalProperties: true

    UpdateVendorRequest:
      type: object
      properties:
        name:
          type: string
          nullable: true
        type:
          type: string
          nullable: true
        email:
          type: string
          nullable: true
        phone:
          type: string
          nullable: true
        website:
          type: string
          nullable: true
        notes:
          type: string
          nullable: true
        isActive:
          type: boolean
          nullable: true

    PaginatedVendorResponse:
      allOf:
        - $ref: "#/components/schemas/PaginatedResponse"
        - type: object
          properties:
            items:
              type: array
              items:
                $ref: "#/components/schemas/VendorResponse"
              description: List of vendors

    VendorContactResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        vendorId:
          type: string
          format: uuid
        firstName:
          type: string
        lastName:
          type: string
        email:
          type: string
        phone:
          type: string
        role:
          type: string
        isPrimary:
          type: boolean
        notes:
          type: string
        createdAt:
          $ref: "#/components/schemas/Timestamp"

    CreateVendorContactRequest:
      type: object
      required:
        - firstName
      properties:
        firstName:
          type: string
        lastName:
          type: string
        email:
          type: string
        phone:
          type: string
        role:
          type: string
        isPrimary:
          type: boolean

    UpdateVendorContactRequest:
      type: object
      properties:
        firstName:
          type: string
          nullable: true
        lastName:
          type: string
          nullable: true
        email:
          type: string
          nullable: true
        phone:
          type: string
          nullable: true
        role:
          type: string
          nullable: true
        isPrimary:
          type: boolean
          nullable: true
